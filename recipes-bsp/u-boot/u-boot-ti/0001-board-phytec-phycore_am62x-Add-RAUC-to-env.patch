From 0472fc3d2e2371fbda17129afefe924d1c8a17ab Mon Sep 17 00:00:00 2001
From: Alexander Bauer <a.bauer@phytec.de>
Date: Mon, 26 Feb 2024 10:02:35 +0100
Subject: [PATCH] Include RAUC boot logic in environment.

Signed-off-by: Leonard Anderweit <l.anderweit at phytec.de>
Signed-off-by: Alexander Bauer <a.bauer at phytec.de>
---
 board/phytec/phycore_am62x/phycore_am62x.env | 5 +++++
 1 file changed, 5 insertions(+)

diff --git a/board/phytec/phycore_am62x/phycore_am62x.env b/board/phytec/phycore_am62x/phycore_am62x.env
index 81f6e783ac..e4b8aa51ed 100644
--- a/board/phytec/phycore_am62x/phycore_am62x.env
+++ b/board/phytec/phycore_am62x/phycore_am62x.env
@@ -1,4 +1,6 @@
 #include <environment/ti/ti_armv7_common.env>
+#include <environment/ti/k3_dfu.env>
+#include <environment/phytec/rauc.env>
 
 name_kern=Image
 console=ttyS2,115200n8
@@ -17,6 +19,9 @@ args_mmc=setenv bootargs console=${console} ${optargs}
 	rootfstype=${mmcrootfstype}
 
 init_mmc=run args_all args_mmc
+init_mmc=
+	if test ${doraucboot} = 1; then run init_rauc; fi;
+	run args_all args_mmc
 get_fdt_mmc=load mmc ${mmcdev}:${bootpart} ${fdtaddr} ${fdtfile}
 get_overlay_mmc=
 	fdt address ${fdtaddr};
-- 
2.25.1

